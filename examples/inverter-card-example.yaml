type: custom:stack-in-card
cards:
  - type: conditional
    conditions:
      - entity: binary_sensor.powmr_inverter_grid_active
        state: unavailable
    card:
      type: markdown
      content: |
        <ha-alert alert-type="warning">Inverter is turned off</ha-alert>
      style: |
        ha-card {
          margin: 0px 0;
          border: 0;
        }
  - type: conditional
    conditions:
      - entity: binary_sensor.powmr_inverter_grid_active
        state_not: unavailable
    card:
      type: vertical-stack
      cards:
        - type: custom:sunsynk-power-flow-card
          cardstyle: lite
          show_solar: true
          panel_mode: true
          large_font: false
          decimal_places: 3
          dynamic_line_width: true
          no_card: true
          card_mod:
            style: |
              ha-card {
                margin-top: -5px !important;
              }
              .card {
                box-shadow: none !important;
              }
          inverter:
            modern: false # Display the inverter using the modern image. Set to false to display an image of the inverter based on the model attribute below.
            colour: grey # Sets the colour of the inverter and data. Hex codes ('#66ff00' etc) or names (red, green, blue etc).
            navigate: # Sets the navigation path when clicking on the inverter image. Can be used to link to other dashboards and views e.g. /lovelace/1.
            autarky: no # Display autarky and ratio as a percentage using either realtime power or daily energy values. Set to no to hide (energy/power/no).
                        # Autarky is the percentage of self sufficiency through Home Production. Ratio is the percentage of produced electricity used by the home.
                        # It is calculated based on the formula below and borrowed from the Power Distribution Card
                        # Autarky in Percent = Home Production / Home Consumption
                        # Ratio in Percent = Home Consumption / Home Production
                        # Home Production = Solar + Battery (discharge) + Aux (in), Home Consumption = Essential power + Nonessential power + Aux (out) + Battery (charge)
            model: powmr # Selects which inverter image and status codes to use. Options are lux, solis, goodwe, goodwe_gridmode, foxess, solax, sunsynk, victron, fronius, solaredge, growatt, sofar, ces-battery-box, deye, azzurro, powmr, mppsolar, smasolar and huawei.
            auto_scale: true # If set to true the card will use the entities unit_of_measurement attribute to perform the correct scaling (i,e, power values greater than 999W will be displayed as kW e.g. 1.23kW) and display the correct unit. The number of decimal places can be changed using the decimal_places card attribute apart from the daily energy values which are set using the decimal_places_energy attribute.
            three_phase: false # If set to true additional 3 phase sensors will be displayed. Requires entity attributes to be defined i.e. inverter_current_L2, inverter_current_L3, inverter_voltage_L2, inverter_voltage_L3 , grid_ct_power_L2, grid_ct_power_L3, load_power_L1, load_power_L2, load_power_L3.
          battery:
            count: 1 # Set the number of batteries to be disaplyed. Two batteries can only be displayed when wide: true.
            show_daily: true # Toggles the daily total. If count: 2 this should be the combined daily total value.
            animation_speed: 6 # Set slowest animation speed in seconds, depending on power draw.
            max_power: 2400 # Maximum power draw to calculate animation speed. Numeric value or sensor i.e. number.battery_maximum_discharging_power.
            path_threshold: 100 # Specify threshold to apply dynamic colour to the battery path element. The colour of the path will change to the source colour if the percentage supply by a single source equals or exceeds this value.
            energy: 2400 # Total battery one energy in Wh (e.g. 3 x 5.32kWh = 15960). If set to 0 the remaining battery one runtime will be hidden. Numeric value or sensor i.e. sensor.sunsynk_battery_energy.
            shutdown_soc: 0 # Battery one shutdown percentage used to calculate remaining runtime. Numeric value or sensor i.e. sensor.sunsynk_battery_capacity_shutdown.
            shutdown_soc_offgrid: # The offgrid battery one shutdown percentage used to calculate remaining runtime. Numeric value or sensor i.e. sensor.offgrid_battery_capacity_shutdown.
            soc_end_of_charge: 100 # Set the charge cut-off capacity. The minimum value is 50. The maximum value is 100. Numeric value or sensor i.e. sensor.soc_end_of_charge.
            soc_decimal_places: # Set the number of decimal places shown for the battery SOC. This setting is only applied if hide_soc: true due to layout constraints.
            invert_power: true # Set to true if your sensor provides a positive number for battery charge and negative number for battery discharge. See also invert_flow: below.
            colour: red # Sets the colour of all the battery one card objects. Hex codes ('#66ff00' etc) or names (red, green, blue etc).
            charge_colour: # Sets the colour of all the battery one card objects when charging. Hex codes ('#66ff00' etc) or names (red, green, blue etc).
            dynamic_colour: true # The battery one icon colour will change based on the % contribution of the power source (grid, solar) supplying the battery. Set to false to disable. If priority_load_243: on solar will prioritise the essential load. If false or ommited solar will prioritise the battery.
            linear_gradient: true # The blocks inside the battery one icon that represent SOC will be coloured using a linear gradient that ranges from red to green.
            animate: true # Animates the linear gradient inside the battery one icon
            show_absolute: true # set to true to display power and current as absolute values.
            auto_scale: true # If set to true the card will use the entities unit_of_measurement attribute to perform the correct scaling (i,e, power values greater than 999W will be displayed as kW e.g. 1.23kW) and display the correct unit. The number of decimal places can be changed using the decimal_places card attribute apart from the daily energy values which are set using the decimal_places_energy attribute.
            hide_soc: false # If set to true the current program capacity (SOC), or the shutdown soc and offgrid shutdown soc that is shown to the left of the current battery one SOC will be hidden.
            show_remaining_energy: true # Set to true to display the remaining battery one energy in kWh based on the current SOC.
            remaining_energy_to_shutdown: false # If set to true the displayed remaining battery energy will be the available energy to the shutdown SOC and not to 0%.
            navigate: # Sets the navigation path when clicking on the battery one image. Can be used to link to other dashboards and views e.g. /lovelace/1.
            invert_flow: false # Inverts the animated flow. Expects a positive number for battery charging and a negative number for battery discharging
          solar:
            colour: orange # Sets the colour of all the solar card objects. Hex codes ('#66ff00' etc) or names (red, green, blue etc).
            show_daily: true # Toggles the daily total.
            display_mode: 3 # 1 - Only display the daily total, 2 - Display the daily total and remaining daily forecast, 3 - Display the daily total and total solar generation.
            dynamic_colour: true # The solar elements on the card will be greyed out if total solar power < 10W.
            mppts: 2 # Specify the number of MPPT’s in use 1-6. Use the wide view to display more than four MPPT’s on the compact or lite cards.
            animation_speed: 9 # Set slowest animation speed in seconds, depending on Power produced.
            max_power: 3600 # Maximum power draw to calculate animation speed. This value is also used to calculate the solar efficiency for the total PV power and should equal the total size of your PV array. Numeric value or sensor.
            pv1_name: PV1 # Set the disaply name for MPPT1.
            pv1_max_power: 3600 # Maximum power of MPPT1 based on the number and size of panels. Used to calculate solar efficiency of the string (W). Numeric value or sensor.
            pv2_name: PV2 # Set the disaply name for MPPT2.
            pv2_max_power: 0 # Maximum power of MPPT2 based on the number and size of panels. Used to calculate solar efficiency of the string (W). Numeric value or sensor.
            auto_scale: true # If set to true the card will use the entities unit_of_measurement attribute to perform the correct scaling (i,e, power values greater than 999W will be displayed as kW e.g. 1.23kW) and display the correct unit. The number of decimal places can be changed using the decimal_places card attribute apart from the daily energy values which are set using the decimal_places_energy attribute.
            efficiency: 3 # 0 - Disabled, 1 - Graphic display, 2 - Text display, 3 - Graphic and text display.
            off_threshold: 10 # When total PV power falls belows this threshold colour will change to grey. Requires dynamic_colour to be enabled.
            navigate: # Sets the navigation path when clicking on the sun image. Can be used to link to other dashboards and views e.g. /lovelace/1.
            invert_flow: false # Inverts the animated flow.
            custom_label: # Set a custom label that overides the default Daily Solar, Daily Solar / Left Today and Daily Solar / Total Solar lablels.
          load:
            colour: "#5fb6ad" # Sets the colour of all the load card objects. Hex codes ('#66ff00' etc) or names (red, green, blue etc).
            off_colour: grey # Sets the off colour for the additional essential loads. Set this to transparent to hide the load when power is below the off_threshold
            max_colour: # Sets the upper threshold colour for the additional essential loads.
            dynamic_colour: true # The essential icon colour will change based on the % contribution of the power source (battery, grid, solar) supplying the load. Set to false to disable.
            dynamic_icon: true # The essential icon will change when there is 100% contribution from a single power source (battery, grid, solar). Set to false to disable.
            invert_load: false # Set to true if your sensor provides a negative number when the load is drawing power.
            show_daily: true # Toggles the daily total.
            show_daily_aux: false # Toggles the daily AUX total. Only displayed if show_aux is set to true.
            show_aux: false # Toggles the display of AUX.
            invert_aux: false # Set to true if your sensor provides a positive number for AUX input and negative number for AUX output.
            show_absolute_aux: false # set to true to display power as an absolute value.
            animation_speed: 8 # Set slowest animation speed in seconds, depending on Power draw.
            max_power: 10200 # Maximum power draw to calculate animation speed. Numeric value or sensor.
            aux_name: Auxilary # Set the display name for the AUX Load.
            aux_daily_name: DAILY AUX # Set the display name for the DAILY AUX label.
            aux_type: default # Sets the AUX image using preset or any mdi icon e.g. mdi:ev-station. Presets are: gen, inverter default, oven, pump, aircon and boiler.
            aux_colour: the load colour # Sets the colour of all the AUX card objects. Hex codes ('#66ff00' etc) or names (red, green, blue etc).
            aux_dynamic_colour: true # The respective aux elements on the card will be greyed out if aux power = 0W.
            aux_off_colour: the load colour # Sets the colour of the AUX icon and label when disconnected. Hex codes ('#66ff00' etc) or names (red, green, blue etc).
            aux_loads: 0 # Display additional loads on the AUX side (0/1/2).
            aux_load1_name: AUX Load 1 # Set the display name for the AUX load 1.
            aux_load2_name: AUX Load 2 # Set the display name for the AUX load 2.
            aux_load1_icon: # Set the AUX load 1 image using any mdi icon e.g. mdi:ev-station. You can also provide a sensor that returns the mdi icon.
            aux_load2_icon: # Set the AUX load 2 image using any mdi icon e.g. mdi:ev-station. You can also provide a sensor that returns the mdi icon.
            essential_name: Essential # Set the display name for the essential load.
            additional_loads: 0 # Display additional loads on the essential side (0/1/2/3/4/5/6). Three loads will only be visable when using the lite and compact card. Four or more loads are only visable on the full card if show_aux: false.
            load1_name: # Set the display name for the essential load 1.
            load1_icon: none # Set the essential load 1 image using preset or any mdi icon e.g. mdi:ev-station Presets are: boiler, pump, aircon, oven. You can also provide a sensor that returns the mdi icon.
            load1_switch: # Provide an entity that can be toggled when clicking on the essential load 1 icon.
            load1_max_threshold: # Set the threshold for the essential load 1 that will activate the max_colour.
            load2_name: # Set the display name for the essential load 2.
            load2_icon: none # Set the essential load 2 image using preset or any mdi icon e.g. mdi:ev-station Presets are: boiler, pump, aircon, oven. You can also provide a sensor that returns the mdi icon.
            load2_switch: # Provide an entity that can be toggled when clicking on the essential load 2 icon.
            load2_max_threshold: # Set the threshold for the essential load 2 that will activate the max_colour.
            auto_scale: true # If set to true the card will use the entities unit_of_measurement attribute to perform the correct scaling (i,e, power values greater than 999W will be displayed as kW e.g. 1.23kW) and display the correct unit. The number of decimal places can be changed using the decimal_places card attribute apart from the daily energy values which are set using the decimal_places_energy attribute.
            off_threshold: 0 # When power falls below this value the load will be considered off and colour will change to grey. Requires dynamic_colour to be enabled. Can also be set to -1 to disable.
            path_threshold: 100 # Specify threshold to apply dynamic colour to the load path element. The colour of the path will change to the source colour if the percentage supply by a single source equals or exceeds this value.
            navigate: # Sets the navigation path when clicking on the essential load image. Can be used to link to other dashboards and views e.g. /lovelace/1.
            invert_flow: false # Inverts the animated flow.
            label_daily_load: DAILY LOAD # Set custom text for the “DAILY LOAD” label that is displayed.
          grid:
            colour: '#5490c2' # Sets the colour of all the grid card objects. Hex codes ('#66ff00' etc) or names (red, green, blue etc).
            grid_name: # Set the display name for the grid.
            export_colour: # Sets the colour of all the grid card objects when exporting (selling) energy. Hex codes ('#66ff00' etc) or names (red, green, blue etc). If not set will use the colour: value defined above.
            no_grid_colour: # Sets the colour of all the grid card objects when there is no grid power. Hex codes ('#66ff00' etc) or names (red, green, blue etc). If not set will use the colour: value defined above total.
            grid_off_colour: # Sets the colour of the grid icon when the grid is disconnected.
            show_daily_buy: true # Toggles the daily buy total.
            show_daily_sell: false # Toggles the daily sell total.
            show_nonessential: true # Toggles the display of non-essential.
            nonessential_icon: default # Change the non-essential image using presets or any mdi icon e.g. mdi:ev-station. Presets are: default  oven,  boiler, pump,  aircon
            nonessential_name: Non Essential # Set the display name for the non-essential load.
            additional_loads: 0 # Toggle the display of additional loads on the non-essential side (0/1/2/3) The third load will only be displayed if the inverter timer schedules are not used or wide screen is selected due to limited space. Set the battery attribute hide_soc: true or wide: true to display the third additional load.
            load1_name: # Set the display name for the non-essential load 1.
            load2_name: # Set the display name for the non-essential load 2.
            load3_name: # Set the display name for the non-essential load 3.
            load1_icon: default # Change the non-essential load 1 image using presets or any mdi icon e.g. mdi:ev-station. Presets are: default, oven, boiler, pump, aircon You can also provide a sensor that returns the mdi icon.
            load2_icon: default # Change the non-essential load 2 image using presets or any mdi icon e.g. mdi:ev-station. Presets are: default, oven, boiler, pump, aircon You can also provide a sensor that returns the mdi icon.
            load3_icon: none # Change the non-essential load 3 image using any mdi icon e.g. mdi:ev-station. You can also provide a sensor that returns the mdi icon.
            invert_grid: false # Set to true if your sensor provides a negative number for grid import and positive number for grid export.
            show_absolute: false # set to true to display power as absolute
            animation_speed: 8 # Set slowest animation speed in seconds, depending on power draw.
            max_power: 14400 # Maximum power draw to calculate animation speed. Numeric value or sensor.
            auto_scale: true # If set to true the card will use the entities unit_of_measurement attribute to perform the correct scaling (i,e, power values greater than 999W will be displayed as kW e.g. 1.23kW) and display the correct unit. The number of decimal places can be changed using the decimal_places card attribute apart from the daily energy values which are set using the decimal_places_energy attribute.
            energy_cost_decimals: 2 # Sets the number of decimal places to display the buy and sell energy costs.
            off_threshold: 0 # When power falls below this value the load will be considered off and colour will change to grey. Requires dynamic_colour to be enabled. Can also be set to -1 to disable.
            import_icon: # Set the grid connected/import image using any mdi icon e.g. mdi:transmission-tower-import. You can also provide a sensor that returns the mdi icon. If defined overrides the card default icon.
            export_icon: # Set the grid export image using any mdi icon e.g. mdi:transmission-tower-export. You can also provide a sensor that returns the mdi icon. If defined overrides the card default icon.
            disconnected_icon: # Set the grid disconnected image using any mdi icon e.g. mdi:transmission-tower-off. You can also provide a sensor that returns the mdi icon. If defined overrides the card default icon.
            label_daily_grid_buy: # Set custom text for the “DAILY GRID BUY” label that is displayed.
            label_daily_grid_sell: # Set custom test for the “DAILY GRID SELL” label that is displayed.
            navigate: # Sets the navigation path when clicking on the grid image. Can be used to link to other dashboards and views e.g. `/lovelace/1.
            invert_flow: false # Inverts the animated flow.
          entities:
            # Solar Entities
            day_pv_energy_108: sensor.powmr_inverter_pv_daily_energy # Daily solar usage (kWh).
            pv1_power_186: sensor.powmr_inverter_pv_power # PV string 1 power (W).
            pv2_power_187: sensor.powmr_inverter_pv2_power # PV string 2 power (W).
            pv_total: sensor.powmr_inverter_pv_total # Provide a sensor for total pv power. If omitted the card uses internal logic to calculate this based on the pv1-4 power (W).
            pv1_voltage_109: sensor.powmr_inverter_pv_voltage # PV string 1 voltage (V).
            pv1_current_110: sensor.powmr_inverter_pv_current # PV string 1 current (A).
            pv2_voltage_111: sensor.powmr_inverter_pv2_voltage # PV string 2 voltage (V).
            pv2_current_112: sensor.powmr_inverter_pv2_current # PV string 2 current (A).
            remaining_solar: sensor.solcast_forecast_remaining_today # The remaining solar forecast for the day (kWh). Use with solar display_mode:2.
            total_pv_generation: sensor.powmr_inverter_pv_total_energy # Total Solar generation (Lifetime or forecast for the day) (kWh). Use with solar display_mode:3.
            solar_sell_247: switch.sunsynk_toggle_solar_sell # Displays icons to indicate if sell solar is active or not. The switch can be toggled by clicking on the icon (on/off, 1/0).
            environment_temp: # Display outside temperature or other environment temperature below the sun icon.
            # Battery Entities
            day_battery_discharge_71: sensor.powmr_inverter_battery_discharge_daily_energy # Daily battery usage (kWh). If you are displaying two batteries on the card this sensor should be the combined total daily discharge. You may need to create a template sensor.
            day_battery_charge_70: sensor.powmr_inverter_battery_charge_daily_energy # Daily battery charge (kWh). If you are displaying two batteries on the card this sensor should be the combined total daily discharge. You may need to create a template sensor.
            battery_power_190: sensor.powmr_inverter_battery_power # Battery power (W). Expects a negative number for battery charging and a positive number for battery discharging. Set the invert_power: battery attribute to yes if your sensor reports this the other way around. Alternatively set invert_flow: battery attribute to yes and provide a positive number for battery charging and a negative number for battery discharging
            battery_current_191: sensor.powmr_inverter_battery_current # Battery current (A).
            battery_temp_182: sensor.battery_maximum_temperature # Battery temperature (°). Note do not define this sensor if you want to display battery SOH. See below.
            battery_voltage_183: sensor.powmr_inverter_battery_voltage # Battery voltage (V).
            battery_soc_184: sensor.powmr_inverter_battery_soc # Battery state of charge (%).
            battery_soh: # Battery State of Health (SOH) (%). You can chose to display either battery temperature or battery SOH but not both. They are displayed in the same place on the card. If battery_temp_182: is defined it will take priority and this sensor will not be displayed.
            battery_rated_capacity: # Battery rated capacity (Ah). If provided this sensor will be used to calculate battery energy. Theenergy attribute under the battery card configuration will be ignored.
            battery_current_direction: # Used only when inverter model is set to solis (0, 1).
            battery_status: # Used only when inverter model is set to goodwe, goodwe_gridmode or huawei. Battery status 0, 1, 2, 3, 4.
            # Inverter Entities
            inverter_status_59: sensor.powmr_inverter_inverter_status # Expects a sensor that contains inverter status represented as a string or number. For Sunsynk 0, 1, 2, 3, 4 or standby, selftest, normal, alarm, fault. For Lux 0,1,2,4,5,7,8,9,10,11,12,16,17,20,32,40,64,136,192. For Solis expects a numeric value 0-57. For Goodwe 0,1,2,3,4,5 or Wait mode, Normal (On-Grid), Normal (Off-Grid), Fault Mode, Flash Mode, Check Mode. For Goodwe_gridmode 0,1,2 or Idle, Exporting, Importing.
            use_timer_248: switch.sunsynk_toggle_system_timer # Displays “Use timer” status as an icon next to the inverter. Set to no to hide.
            #priority_load_243: switch.sunsynk_toggle_priority_load # Shows if energy pattern is set to priority load or priority battery as an icon next to the inverter. Set to no to hide.
            inverter_voltage_154: sensor.powmr_inverter_load_voltage # Inverter L1 voltage (V).
            #inverter_voltage_L2: # Inverter L2 voltage (V).
            #inverter_voltage_L3: # Inverter L3 voltage (V).
            load_frequency_192: sensor.powmr_inverter_load_frequency # Load frequency (Hz).
            inverter_current_164: sensor.powmr_inverter_load_current # Inverter L1 current (A).
            #inverter_current_L2: # Inverter L2 current (A).
            #inverter_current_L3: # Inverter L3 current (A).
            inverter_power_175: sensor.powmr_inverter_load_active_power # Inverter power (W). Required if the essential_power attribute is set to none.
            grid_power_167: sensor.powmr_inverter_pzem_004t_grid_active_power # Grid power (W) See NOTE below. Use 167 (Grid LD Power) if non-essential and essential readings are wrong. Required if the nonessential_power attribute is set to none.
            #grid_power_169: sensor.powmr_inverter_pzem_004t_grid_active_power # Grid power (W) See NOTE below. Use 167 (Grid LD Power) if non-essential and essential readings are wrong. Required if the nonessential_power attribute is set to none.
            radiator_temp_91: sensor.powmr_inverter_internal_temperature # Inverter AC temperature (℃).
            #dc_transformer_temp_90: # Inverter DC temperature (℃).
            #prog1_time: sensor.sunsynk_time_slot_1 # Program 1 start time (HH:MM).
            #prog1_capacity: number.sunsynk_system_mode_soc_time1 # Program 1 capacity (SOC) setting.
            #prog1_charge: switch.sunsynk_system_mode_grid_charge_time1 # Program 1 charge options (on/off, 1/0, No Grid or Gen).
            #prog2_time: sensor.sunsynk_time_slot_2 # Program 2 start time (HH:MM).
            #prog2_capacity: number.sunsynk_system_mode_soc_time2 # Program 2 capacity (SOC) setting.
            #prog2_charge: switch.sunsynk_system_mode_grid_charge_time2 # Program 2 charge options (on/off, 1/0, No Grid or Gen).
            # Load Entities
            day_load_energy_84: sensor.powmr_inverter_load_daily_active_energy # Daily load (kWh).
            #day_aux_energy: # Sensor that provides the daily AUX energy (kWh).
            #essential_power: none # The card will automatically calculate this sensor based on the formula below if the attribute is set to none or the sensor is not defined. You can overide this by supplying a sensor that measures essential power e.g. Load power Essential in the case of Solar Assistant (W).
            #essential_load1: # Sensor that contains the power of your essential load 1 (W). Can also be used to display any sensor data i.e. temp, energy etc if auto_scale: false.
            #essential_load2: # Sensor that contains the power of your essential load 2 (W). Can also be used to display any sensor data i.e. temp, energy etc if auto_scale: false.
            #essential_load3: # Sensor that contains the power of your essential load 3 (W). Can also be used to display any sensor data i.e. temp, energy etc if auto_scale: false For lite and compact cards.
            #essential_load4: # Sensor that contains the power of your essential load 4 (W). Can also be used to display any sensor data i.e. temp, energy etc if auto_scale: false.
            #essential_load5: # Sensor that contains the power of your essential load 5 (W). Can also be used to display any sensor data i.e. temp, energy etc if auto_scale: false.
            #essential_load6: # Sensor that contains the power of your essential load 6 (W). Can also be used to display any sensor data i.e. temp, energy etc if auto_scale: false.
            #essential_load1_extra: # Sensor that contains additional information you want displayed for your essential load 1 e.g. Daily kWh, Temperature etc.
            #essential_load2_extra: # Sensor that contains additional information you want displayed for your essential load 2 e.g. Daily kWh, Temperature etc.
            #essential_load3_extra: # Sensor that contains additional information you want displayed for your essential load 3 e.g. Daily kWh, Temperature etc.
            #essential_load4_extra: # Sensor that contains additional information you want displayed for your essential load 4 e.g. Daily kWh, Temperature etc.
            #essential_load5_extra: # Sensor that contains additional information you want displayed for your essential load 5 e.g. Daily kWh, Temperature etc.
            #essential_load6_extra: # Sensor that contains additional information you want displayed for your essential load 6 e.g. Daily kWh, Temperature etc.
            #load_power_L1: # Load L1 Power (W).
            #load_power_L2: # Load L2 Power (W).
            #load_power_L3: # Load L3 Power (W).
            #aux_power_166: sensor.sunsynk_aux_power # Auxilary power (W).
            #aux_load1: # Sensor that contains the power of your AUX load 1 (W).
            #aux_load2: # Sensor that contains the power of your AUX load 2 (W).
            #aux_load1_extra: # Sensor that contains additional information you want displayed for your aux load 1 e.g. Daily kWh, Temperature etc. This entity can also be used to display additioanl sensor information above the aux icon when aux_loads: 0.
            #aux_load2_extra: # Sensor that contains additional information you want displayed for your aux load 2 e.g. Daily kWh, Temperature etc.
            #aux_connected_status: # AUX Connected Status on/off or 1/0.
            # Grid Entities
            day_grid_import_76: sensor.powmr_inverter_pzem_004t_grid_daily_energy # Daily grid import (kWh).
            #day_grid_export_77: sensor.sunsynk_day_grid_export # Daily grid export (kWh).
            grid_ct_power_172: sensor.powmr_inverter_pzem_004t_grid_active_power # Grid CT L1 power (W).
            #grid_ct_power_L2: none # Grid CT L2 power (W).
            #grid_ct_power_L3: none # Grid CT L3 power (W).
            #grid_ct_power_total: # For three phase systems. The card will automatically calculate this based on (Grid CT L1 power + Grid CT L2 power + Grid CT L3 power) You can optionally provide your own sensor for total grid power. (W).
            grid_voltage: sensor.powmr_inverter_grid_voltage # Sensor providing grid voltage (v). Used only when inverter model is set to solis.
            #nonessential_power: none # The card will automatically calculate this sensor based on the formula below if the attribute is set to none or the sensor is not defined. You can overide this by supplying a sensor that measures non-essential power e.g. Load power Non-Essential in the case of Solar Assistant. You can also disable this sensor by setting it’s value to any arbitrary value i.e. nonessential_power: no and it will display a zero value and not effect autarky and ratio calculations (W).
            #non_essential_load1: # Sensor that contains the power of your non-essential load 1 (W).
            #non_essential_load2: # Sensor that contains the power of your non-essential load 2 (W).
            #non_essential_load3: # Sensor that contains the power of your non-essential load 3 (W).
            #non_essential_load1_extra: # Sensor that contains additional information you want displayed for your nonessential load 1 e.g. Daily kWh, Temperature etc.
            #non_essential_load2_extra: # Sensor that contains additional information you want displayed for your nonessential load 2 e.g. Daily kWh, Temperature etc.
            grid_connected_status_194: binary_sensor.powmr_inverter_grid_active # Grid connected status (case insensitive) on/off,1/0, On-Grid/Off-Grid, or On Grid/Off Grid.
            #energy_cost_buy: # Sensor that provides current sell energy cost per kWh.
            #energy_cost_sell: # Sensor that provides current sell energy cost per kWh.
            #prepaid_units: # Account balance of prepaid electricity units.
            #max_sell_power: # Sets the maximum allowed output power to flow to the grid. Also known as “Export Control User Limit” (W). 
        - type: custom:stack-in-card
          mode: vertical
          no_card: true
          card_mod:
            style: |
              ha-card {
                margin-top: -10px !important;
              }
          cards:
            - type: custom:tabbed-card
              tabs:
                - attributes:
                    label: General
                    icon: mdi:book
                  card:
                    type: grid
                    square: false
                    cards:
                      - type: tile
                        entity: binary_sensor.powmr_inverter_battery_charge
                        name: Battery Charge
                        no_card: true
                      - type: tile
                        entity: binary_sensor.powmr_inverter_battery_discharge
                        name: Battery Discharge
                        no_card: true
                      - type: tile
                        entity: binary_sensor.powmr_inverter_grid_active
                        name: Grid Active
                        no_card: true
                      - type: tile
                        entity: binary_sensor.powmr_inverter_pv_active
                        name: PV Active
                        no_card: true
                      - type: tile
                        entity: binary_sensor.powmr_inverter_load_enabled
                        name: Load Enabled
                        no_card: true
                      - type: tile
                        entity: sensor.powmr_inverter_load_percent
                        name: Load
                        no_card: true
                    columns: 3
                - attributes:
                    label: Sensors
                    icon: mdi:eye
                  card:
                    type: grid
                    square: false
                    cards:
                      - type: tile
                        entity: sensor.powmr_inverter_inverter_status
                        name: Inverter Status
                        no_card: true
                      - type: tile
                        entity: sensor.powmr_inverter_alarm_codes
                        name: Alarm Codes
                        no_card: true 
                      - type: tile
                        entity: sensor.powmr_inverter_inverter_faults
                        name: Inverter Faults
                        no_card: true  
                      - type: tile
                        entity: sensor.powmr_inverter_internal_temperature
                        name: Internal Temperature
                        no_card: true
                      - type: tile
                        entity: sensor.powmr_inverter_esp32_powmr_inverter_temperature
                        name: ESP32 PowMr Inverter Temperature
                        no_card: true
                      - type: tile
                        entity: sensor.powmr_inverter_esp32_powmr_inverter_rssi
                        name: ESP32 PowMr Inverter RSSI
                        no_card: true
                      - type: tile
                        entity: sensor.powmr_inverter_uptime
                        name: Uptime
                        no_card: true
                      - type: tile
                        entity: sensor.powmr_inverter_inverter_mode
                        name: Inverter Mode
                        no_card: true
                      - type: tile
                        entity: sensor.powmr_inverter_battery_configuration
                        name: Battery Configuration
                        no_card: true
                      - type: tile
                        entity: sensor.powmr_inverter_main_cpu_version
                        name: Inverter Firmware Version
                        no_card: true
                    columns: 2
                - attributes:
                    label: Controls
                    icon: mdi:cog
                  card:
                    type: grid
                    square: false
                    columns: 2
                    cards:
                    # Menu Setting #00
                      - type: tile
                        entity: switch.powmr_inverter_restore_factory_defaults
                        name: Restore Factory Defaults
                        no_card: true
                    # Menu Setting #01
                      - type: tile
                        entity: select.powmr_inverter_output_source_priority
                        name: Output Source Priority
                        no_card: true
                    # Menu Setting #02  
                      - type: tile
                        entity: select.powmr_inverter_maximum_charging_current
                        name: Maximum Charging Current
                        no_card: true
                    # Menu Setting #03
                      - type: tile
                        entity: select.powmr_inverter_ac_input_voltage_range
                        name: AC Input Voltage Range
                        no_card: true
                    # Menu Setting #05
                      - type: tile
                        entity: select.powmr_inverter_battery_type
                        name: Battery Type
                        no_card: true
                    # Menu Setting #06
                      - type: tile
                        entity: switch.powmr_inverter_auto_restart_when_overload_occurs
                        name: Auto restart when overload occurs
                        no_card: true
                    # Menu Setting #07
                      - type: tile
                        entity: switch.powmr_inverter_auto_restart_when_over_temperature
                        name: Auto restart when over temperature
                        no_card: true
                    # Menu Setting #09
                      - type: tile
                        entity: select.powmr_inverter_output_frequency
                        name: Output frequency
                        no_card: true     
                    # Menu Setting #10 
                      - type: tile
                        entity: select.powmr_inverter_output_voltage
                        name: Output Voltage
                        no_card: true      
                    # Menu Setting #11    
                      - type: tile
                        entity: select.powmr_inverter_maximum_utility_charging_current
                        name: Maximum Utility Charging Current
                        no_card: true
                    # Menu Setting #12
                      - type: tile
                        entity: select.powmr_inverter_soc_back_to_utility_source_voltage
                        name: SOC Back To Utility Source Voltage
                        no_card: true   
                    # Menu Setting #13
                      - type: tile
                        entity: select.powmr_inverter_soc_back_to_battery_voltage
                        name: SOC Back To Battery Voltage
                        no_card: true          
                    # Menu Setting #16
                      - type: tile
                        entity: select.powmr_inverter_charger_source_priority
                        name: Charger Source Priority
                        no_card: true
                    # Menu Setting #18
                      - type: tile
                        entity: switch.powmr_inverter_alarm_control
                        name: Alarm Control
                        no_card: true
                    # Menu Setting #19
                      - type: tile
                        entity: switch.powmr_inverter_auto_return_to_default_display_screen
                        name: Auto return to default display screen
                        no_card: true
                    # Menu Setting #20
                      - type: tile
                        entity: switch.powmr_inverter_backlight_control
                        name: Backlight Control
                        no_card: true
                   # Menu Setting #22
                      - type: tile
                        entity: switch.powmr_inverter_beep_on_primary_source_fail
                        name: Beep On Primary Source Fail
                        no_card: true
                  # Menu Setting #23
                      - type: tile
                        entity: switch.powmr_inverter_overload_bypass
                        name: Overload Bypass
                        no_card: true
                  # Menu Setting #25
                      - type: tile
                        entity: switch.powmr_inverter_record_fault_code
                        name: Record fault code
                        no_card: true
                  # Menu Setting #26
                      - type: tile
                        entity: number.powmr_inverter_bulk_charging_voltage
                        name: Bulk Charging Voltage
                        no_card: true  
                  # Menu Setting #27
                      - type: tile
                        entity: number.powmr_inverter_floating_charging_voltage
                        name: Floating charging voltage
                        no_card: true 
                  # Menu Setting #29
                      - type: tile
                        entity: number.powmr_inverter_low_dc_cut_off_voltage
                        name: Low DC cut-off voltage
                        no_card: true           
                  # Menu Setting #30
                      - type: tile
                        entity: switch.powmr_inverter_battery_equalization
                        name: Battery Equalization
                        no_card: true
                  # Menu Setting #31
                      - type: tile
                        entity: number.powmr_inverter_battery_equalization_voltage
                        name: Battery Equalization voltage
                        no_card: true
                  # Menu Setting #33
                      - type: tile
                        entity: number.powmr_inverter_battery_equalized_time
                        name: Battery Equalized time
                        no_card: true   
                  # Menu Setting #34
                      - type: tile
                        entity: number.powmr_inverter_battery_equalized_timeout
                        name: Battery Equalized timeout
                        no_card: true  
                  # Menu Setting #35
                      - type: tile
                        entity: number.powmr_inverter_battery_equalization_interval
                        name: Battery Equalization interval
                        no_card: true           
                  # Menu Setting #36
                      - type: tile
                        entity: switch.powmr_inverter_battery_equalization_activated_immediately
                        name: Battery Equalization activated immediately
                        no_card: true
                  # Menu Setting #37
                      - type: tile
                        entity: switch.powmr_inverter_grid_tie_operation
                        name: GRID-tie Operation
                        no_card: true
                  # Menu Setting #38
                      - type: tile
                        entity: number.powmr_inverter_grid_tie_current
                        name: GRID-tie Current
                        no_card: true
                  # Menu Setting #39      
                      - type: tile
                        entity: switch.powmr_inverter_led_pattern_light
                        name: LED Pattern Light
                        no_card: true
                  # Menu Setting #41
                      - type: tile
                        entity: switch.powmr_inverter_dual_output
                        name: Dual Output
                        no_card: true
                  # Menu Setting #42
                      - type: tile
                        entity: number.powmr_inverter_exit_the_dual_output_voltage_point
                        name: Exit The Dual Output Voltage Point
                        no_card: true
                  # Button PV Total Energy Reset
                      - type: tile
                        entity: button.powmr_inverter_pv_total_energy_reset
                        name: PV Total Energy Reset
                        no_card: true
                  # Button PZEM-004T Grid Total Energy Reset
                      - type: tile
                        entity: button.powmr_inverter_pzem_004t_grid_total_energy_reset
                        name: PZEM-004T Grid Total Energy Reset
                        no_card: true
                  # Button PZEM-004T Load Total Energy Reset
                      - type: tile
                        entity: button.powmr_inverter_pzem_004t_load_total_energy_reset
                        name: PZEM-004T Load Total Energy Reset
                        no_card: true
grid_options:
  columns: 24
  rows: 2
